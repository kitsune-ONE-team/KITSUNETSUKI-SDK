- job-template:
    name: 'panda3d-{module}-{arch}'
    display-name: 'panda3d-{module}-{arch}'
    project-type: freestyle
    description: '{desc}'
    node: '{node}'
    build-discarder:
        daysToKeep: -1
        numToKeep: 2
        artifactDaysToKeep: -1
        artifactNumToKeep: -1
    scm:
        - git:
            url: https://github.com/kitsune-ONE-team/panda3d-{module}.git
            branches:
              - refs/tags/{version}
            wipe-workspace: false
    builders:
        - cmake:
            source-dir: .
            working-dir: '{build}'
            generator: '{generator}'
            build-type: Release
            other-arguments: |
                -DBULLET_INCLUDE_DIR={bullet_dir}include
                -DBULLET_LIBRARY_DIR={bullet_dir}lib
                -DCMAKE_INSTALL_PREFIX={install}
                -DINSTALL_PY=ON
                -DINTERROGATE_EXECUTABLE={interrogate_executable}
                -DINTERROGATE_LIBRARY_DIR={interrogate_library}
                -DINTERROGATE_MODULE_EXECUTABLE={interrogate_module_executable}
                -DINTERROGATE_SOURCE_DIR={interrogate_source}
                -DMULTITHREADED_BUILD=16
                -DPANDA_INCLUDE_DIR={panda3d_dir}include
                -DPANDA_LIBRARY_DIR={panda3d_dir}lib
                -DPYTHON_EXECUTABLE={python_executable}
                -DPYTHON_INCLUDE_DIR={python_include}
                -DPYTHON_LIBRARY={python_library}
                -DWITH_TESTS={with_tests}
            build-tool-invocations:
                - use-cmake: false
                  arguments: '{make}'
                - use-cmake: false
                  arguments: 'install {make}'

- project:
    name: panda3d-extras
    jobs:
        - 'panda3d-{module}-{arch}':
            arch: lynx64
            build: /var/opt/kitsunetsuki-sdk/build/panda3d-kphys
            bullet_dir: /var/opt/kitsunetsuki-sdk/dist/bullet/
            desc: Physics extensions for Panda3D
            generator: Unix Makefiles
            install: /var/opt/kitsunetsuki-sdk/dist/panda3d-kphys/lib/python3.14t/site-packages
            interrogate_executable: /var/opt/kitsunetsuki-sdk/dist/interrogate/bin/interrogate
            interrogate_library: /var/opt/kitsunetsuki-sdk/dist/interrogate/lib
            interrogate_module_executable: /var/opt/kitsunetsuki-sdk/dist/interrogate/bin/interrogate_module
            interrogate_source: /var/opt/kitsunetsuki-sdk/jenkins/workspace/interrogate-lynx64
            make: '-j 16'
            module: kphys
            node: linux
            panda3d_dir: /var/opt/kitsunetsuki-sdk/dist/panda3d/
            python_executable: /var/opt/kitsunetsuki-sdk/dist/python/bin/python3.14t
            python_include: /var/opt/kitsunetsuki-sdk/dist/python/include/python3.14t
            python_library: /var/opt/kitsunetsuki-sdk/dist/python/lib/libpython3.14t.so.1.0
            version: '0.7.16'
            with_tests: ON
        - 'panda3d-{module}-{arch}':
            arch: winx64
            build: 'D:\\build\\panda3d-kphys'
            bullet_dir: 'D:\\dist\\bullet\\'
            desc: Physics extensions for Panda3D
            generator: NMake Makefiles
            install: 'D:\\dist\\panda3d-kphys\\lib\site-packages'
            interrogate_executable: 'D:\\dist\\interrogate\\bin\\interrogate'
            interrogate_library: 'D:\\dist\\interrogate\\lib'
            interrogate_module_executable: 'D:\\dist\\interrogate\\bin\\interrogate_module'
            interrogate_source: 'D:\\jenkins\\workspace\\interrogate-winx64'
            make: ''
            module: kphys
            node: windows
            panda3d_dir: 'D:\\dist\\panda3d\\'
            python_executable: 'D:\\dist\\python\\bin\\python3.14t'
            python_include: 'D:\\dist\\python\\include'
            python_library: 'D:\\dist\\python\\libs\\python314t.lib'
            version: '0.7.16'
            with_tests: OFF
        - 'panda3d-{module}-{arch}':
            arch: lynx64
            build: /var/opt/kitsunetsuki-sdk/build/panda3d-krender
            bullet_dir: /var/opt/kitsunetsuki-sdk/dist/bullet/
            desc: Custom Deferred Render Pipeline for Panda3D
            generator: Unix Makefiles
            install: /var/opt/kitsunetsuki-sdk/dist/panda3d-krender/lib/python3.14t/site-packages
            interrogate_executable: /var/opt/kitsunetsuki-sdk/dist/interrogate/bin/interrogate
            interrogate_library: /var/opt/kitsunetsuki-sdk/dist/interrogate/lib
            interrogate_module_executable: /var/opt/kitsunetsuki-sdk/dist/interrogate/bin/interrogate_module
            interrogate_source: /var/opt/kitsunetsuki-sdk/jenkins/workspace/interrogate-lynx64
            make: '-j 16'
            module: krender
            node: linux
            panda3d_dir: /var/opt/kitsunetsuki-sdk/dist/panda3d/
            python_executable: /var/opt/kitsunetsuki-sdk/dist/python/bin/python3.14t
            python_include: /var/opt/kitsunetsuki-sdk/dist/python/include/python3.14t
            python_library: /var/opt/kitsunetsuki-sdk/dist/python/lib/libpython3.14t.so.1.0
            version: '0.2.15'
            with_tests: ON
        - 'panda3d-{module}-{arch}':
            arch: winx64
            build: 'D:\\build\\panda3d-krender'
            bullet_dir: 'D:\\dist\\bullet\\'
            desc: Custom Deferred Render Pipeline for Panda3D
            generator: NMake Makefiles
            install: 'D:\\dist\\panda3d-krender\\lib\site-packages'
            interrogate_executable: 'D:\\dist\\interrogate\\bin\\interrogate'
            interrogate_library: 'D:\\dist\\interrogate\\lib'
            interrogate_module_executable: 'D:\\dist\\interrogate\\bin\\interrogate_module'
            interrogate_source: 'D:\\jenkins\\workspace\\interrogate-winx64'
            make: ''
            module: krender
            node: windows
            panda3d_dir: 'D:\\dist\\panda3d\\'
            python_executable: 'D:\\dist\\python\\bin\\python3.14t'
            python_include: 'D:\\dist\\python\\include'
            python_library: 'D:\\dist\\python\\libs\\python314t.lib'
            version: '0.2.15'
            with_tests: OFF
