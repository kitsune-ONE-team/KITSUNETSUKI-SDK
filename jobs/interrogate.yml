- job-template:
    name: 'interrogate-{arch}'
    display-name: 'interrogate-{arch}'
    project-type: freestyle
    description:  Python binding generator for Panda3D
    node: '{node}'
    build-discarder:
        daysToKeep: -1
        numToKeep: 2
        artifactDaysToKeep: -1
        artifactNumToKeep: -1
    scm:
        - git:
            url: https://github.com/panda3d/interrogate.git
            branches:
              # must match the version in panda3d/dtool/Config.cmake
              - 7cf2550d2c8d95b8c268aa4bb0b5602e85a086dc
            wipe-workspace: false
    builders:
        - cmake:
            source-dir: .
            working-dir: '{build}'
            generator: '{generator}'
            build-type: Release
            other-arguments: |
                -DBISON_EXECUTABLE={bison_executable}
                -DBUILD_SHARED_LIBS=OFF
                -DCMAKE_INSTALL_PREFIX={install}
                -DFLEX_EXECUTABLE={flex_executable}
                -DHAVE_BISON=YES
                -DHAVE_FLEX=YES
                -DHAVE_PYTHON=YES
                -DMULTITHREADED_BUILD=16
                -DPython_EXECUTABLE={python_executable}
                -DPython_INCLUDE_DIR={python_include}
                -DPython_LIBRARY={python_library}
                -DPython_LIBRARY_RELEASE={python_library}
            build-tool-invocations:
                - use-cmake: false
                  arguments: '{make}'
                - use-cmake: false
                  arguments: 'install {make}'

- project:
    name: interrogate
    jobs:
        - 'interrogate-{arch}':
            arch: lynx64
            bison_executable: /usr/bin/bison
            build: /var/opt/kitsunetsuki-sdk/build/interrogate
            flex_executable: /usr/bin/flex
            generator: Unix Makefiles
            install: /var/opt/kitsunetsuki-sdk/dist/interrogate
            make: '-j 16'
            node: linux
            python_executable: /var/opt/kitsunetsuki-sdk/dist/python/bin/python3.14t
            python_include: /var/opt/kitsunetsuki-sdk/dist/python/include/python3.14t
            python_library: /var/opt/kitsunetsuki-sdk/dist/python/lib/libpython3.14t.so.1.0
        - 'interrogate-{arch}':
            arch: winx64
            bison_executable: 'D:\\jenkins\\workspace\\panda3d-thirdparty-winx64\\panda3d-1.10.16\\thirdparty\win-util\\bison'
            build: 'D:\\build\\interrogate'
            flex_executable: 'D:\\jenkins\\workspace\\panda3d-thirdparty-winx64\\panda3d-1.10.16\\thirdparty\win-util\\flex'
            generator: NMake Makefiles
            install: 'D:\\dist\\interrogate'
            make: ''
            node: windows
            python_executable: 'D:\\dist\\python\\bin\\python3.14t'
            python_include: 'D:\\dist\\python\\include'
            python_library: 'D:\\dist\\python\\libs\\python314t.lib'
